(this["webpackJsonpsmart-face"]=this["webpackJsonpsmart-face"]||[]).push([[0],{120:function(e,t,a){},147:function(e,t,a){},148:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),o=a.n(c),i=(a(120),a(7)),s=a(103),l=a(71),u=a.n(l),d=a(91),j=a(20),b=a(191),p=a(193),O=a(194),m=a(218),f=a(49),h=a(210),g=a(196),x=a(197),y=a(198),v=a(211),S=a(97),w=a.n(S),C=a(41),T="FORM_START",A="FORM_SUCCESS",k="FORM_FAILED",E="SET_IMAGE_URL",_="FACE_ANALYZE_START",F="FACE_ANALYZE_SUCCESS",I="FACE_ANALYZE_FAILED",D="IMAGE_UPLOAD_START",N="IMAGE_UPLOAD_SUCCESS",R="IMAGE_UPLOAD_FAILED",P="IMAGE_UPLOAD_PROGRESS",L="UPDATE_DATA",U="VERIFY_TOKEN_START",W="VERIFY_TOKEN_SUCCESS",M="VERIFY_TOKEN_FAILED",H="GET_PROFILE_DATA_START",G="GET_PROFILE_DATA_SUCCESS",V="GET_PROFILE_DATA_FAILED",z=a(51),Y=a.n(z),B=Y.a.create({baseURL:"https://corsto.herokuapp.com/https://smart-face-api.herokuapp.com",headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*"}}),q=function(e){return{type:W,id:e}},K=function(e,t,a){var n=e.emailTextFieldValue,r=e.passwordTextFieldValue,c=e.nameTextFieldValue;return function(e){e({type:T});var o=t?"/register":"/signin";B.post(o,{email:n,name:c,password:r}).then((function(n){var r,c=n.headers["auth-token"];localStorage.setItem("auth-token",c),e((r=n.data.user,{type:L,user:r})),e(function(e){return{type:A,token:e}}(c)),t?a.push("/"):a.push("/face")})).catch((function(t){var a;console.log(t.response.status),e((a=t.response,{type:k,error:a}))}))}},Z=function(){return{type:_}},J=function(e){var t=e.boxes,a=e.user;return console.log(a),{type:F,user:a,boxes:t}},X=function(e){return{type:I,error:e}},$=function(e,t){var a=t.width,n=t.height;console.log(e);var r,c=e.data.clarifai.outputs[0].data.regions;return c&&(r=c.map((function(e){var t=e.region_info.bounding_box;return{leftCol:t.left_col*a,topRow:t.top_row*n,rightCol:a-t.right_col*a,bottomRow:n-t.bottom_row*n}}))),{boxes:r,user:e.data.user}},Q=function(e){return function(t){console.log(e),t({type:D});var a=new FormData;a.append("file",e),a.append("randomname","randomname");var n={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var a=Math.round(100*e.loaded/e.total);t({type:P,value:a})}};Y.a.post("https://corsto.herokuapp.com/https://uguu.se/api.php?d=upload-tool",a,n).then((function(e){var a;t((a=e.data,{type:N,url:a}))})).catch((function(e){return t({type:R,error:e})}))}},ee=function(e){return function(t){void 0!==e&&(t({type:H}),B.post("/profile",{id:e}).then((function(e){return t(function(e){return console.log(e),{type:G,user:e.data.user}}(e))})).catch((function(e){return t({type:V,error:e})})))}},te=a(13),ae=a(213),ne=a(15),re=a(215),ce=a(3),oe=Object(v.a)((function(e){return{paper:{marginTop:e.spacing(2),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(2),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),ie=function(e){var t=oe(),a="/register"===e.location.pathname,r=Object(n.useState)(),c=Object(j.a)(r,2),o=c[0],s=c[1],l=Object(n.useState)(),u=Object(j.a)(l,2),d=u[0],v=u[1],S=Object(n.useState)(),T=Object(j.a)(S,2),A=T[0],k=T[1],E=Object(n.useState)(!1),_=Object(j.a)(E,2),F=_[0],I=_[1],D=Object(ne.g)(),N=Object(te.b)(),R=Object(te.c)((function(e){return e.form.error})),P=(Object(te.c)((function(e){return e.form.user})),Object(te.c)((function(e){return e.form.loading}))),L=function(e,t){"clickaway"!==t&&I(!1)},U=function(e){return Object(ce.jsx)(ae.a,Object(i.a)({elevation:6,variant:"filled"},e))};return Object(n.useEffect)((function(){I(!1),R&&I(!0)}),[R]),Object(ce.jsx)(ce.Fragment,{children:Object(ce.jsxs)(b.a,{maxWidth:"sm",children:[Object(ce.jsx)(re.a,{open:F,autoHideDuration:6e3,onClose:L,children:Object(ce.jsx)(U,{onClose:L,severity:"error",children:R?"Something went wrong, please try again later":null})}),Object(ce.jsx)(p.a,{children:Object(ce.jsx)(O.a,{children:Object(ce.jsxs)("div",{className:t.paper,children:[Object(ce.jsx)(m.a,{className:t.avatar,children:Object(ce.jsx)(w.a,{})}),Object(ce.jsx)(f.a,{component:"h1",variant:"h5",children:a?"Register":"Sign In"}),Object(ce.jsxs)("form",{onSubmit:function(e){e.preventDefault(),N(K({emailTextFieldValue:o,passwordTextFieldValue:d,nameTextFieldValue:A},a,D))},method:"post",className:t.form,noValidate:!0,children:[Object(ce.jsx)(h.a,{disabled:!!P,error:!!R,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){return s(e.target.value)}}),Object(ce.jsx)(h.a,{disabled:!!P,error:!!R,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return v(e.target.value)}}),a?Object(ce.jsx)(h.a,{disabled:!!P,error:!!R,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"name",label:"Name",type:"text",id:"name",onChange:function(e){return k(e.target.value)}}):null,Object(ce.jsx)(g.a,{className:t.submit,type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:!!P,children:a?"Register":"Sign In"}),P?Object(ce.jsx)(x.a,{}):Object(ce.jsx)(y.a,{container:!0,justify:"center",children:Object(ce.jsx)(y.a,{item:!0,children:Object(ce.jsx)(C.b,{to:a?"/":"/register",children:a?"Already have an account? Sign in":"Don't have an account? Sign Up"})})})]})]})})})]})})},se=Object(v.a)({gridStyle:{height:"100vh"}}),le=function(e){var t=se();return Object(ce.jsx)(y.a,{className:t.gridStyle,container:!0,direction:"row",justify:"center",alignItems:"center",children:Object(ce.jsx)(y.a,{item:!0,children:e.children})})},ue=(a(147),a(33)),de=a(192),je=a(209),be=a(195),pe=a(199),Oe=a(200),me=Object(v.a)((function(e){return{root:{display:"flex",flexDirection:"row",backgroundColor:e.palette.background.paper},primary:{variant:"h2"}}})),fe={variant:"h3",align:"center"},he={variant:"body1",align:"center"},ge=function(){var e=me(),t=Object(te.c)((function(e){return e.face.user})),a=t.user_faces,n=t.user_used,r=t.rank;return Object(ce.jsx)(ce.Fragment,{children:Object(ce.jsxs)(be.a,{className:e.root,children:[Object(ce.jsx)(pe.a,{className:e.container,children:Object(ce.jsx)(Oe.a,{secondaryTypographyProps:he,primaryTypographyProps:fe,primary:n,secondary:"Used"})}),Object(ce.jsx)(pe.a,{className:e.container,children:Object(ce.jsx)(Oe.a,{secondaryTypographyProps:he,primaryTypographyProps:fe,primary:a,secondary:"Faces Regonized"})}),Object(ce.jsx)(pe.a,{className:e.container,children:Object(ce.jsx)(Oe.a,{secondaryTypographyProps:he,primaryTypographyProps:fe,primary:r,secondary:"Rank"})})]})})},xe=a(102),ye=a(100),ve=a.n(ye),Se=a(98),we=a.n(Se),Ce=a(104),Te=a(207),Ae=a(216),ke=a(201),Ee=a(202),_e=a(203),Fe=a(204),Ie=Object(v.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})),De=function(e){var t=e.open,a=e.onClose,r=Object(n.useState)(),c=Object(j.a)(r,2),o=c[0],i=c[1],s=Object(te.b)(),l=Ie();return Object(ce.jsxs)(Ae.a,{open:t,onClose:a,className:l.formControl,children:[Object(ce.jsx)(ke.a,{children:"Enter Image url"}),Object(ce.jsxs)(Ee.a,{children:[Object(ce.jsx)(_e.a,{children:"Please enter a valid image url, preferably image with faces ;)"}),Object(ce.jsx)(h.a,{onChange:function(e){return i(e.target.value)},autoFocus:!0,margin:"dense",id:"name",label:"Image Url",type:"text",placeholder:"http://www.example.com/image.jpg",fullWidth:!0})]}),Object(ce.jsxs)(Fe.a,{children:[Object(ce.jsx)(g.a,{onClick:a,color:"primary",children:"Cancel"}),Object(ce.jsx)(g.a,{onClick:function(){s({type:E,url:o}),a()},color:"primary",children:"Submit"})]})]})},Ne=a(99),Re=a.n(Ne),Pe=a(206),Le=a(205),Ue=a(212),We=Object(v.a)((function(){return{loader:{color:"white"},colorPrimary:{color:"white"}}})),Me=function(e){var t=Object(te.c)((function(e){return e.face.progress})),a=We();return Object(ce.jsxs)(Ue.a,{position:"relative",display:"inline-flex",children:[Object(ce.jsx)(Le.a,{thickness:"1.5",className:a.colorPrimary,variant:"caption",size:25,value:t}),Object(ce.jsx)(Ue.a,{color:"white",top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(ce.jsx)(f.a,{variant:"caption",component:"div",children:"".concat(t,"%")})})]})},He=Object(v.a)((function(e){return{loader:{color:"white"}}})),Ge=function(e){var t=Object(te.b)(),a=Object(n.useState)(!1),r=Object(j.a)(a,2),c=r[0],o=r[1],i=Object(te.c)((function(e){return e.face.url})),s=Object(te.c)((function(e){return e.face.loading})),l=Object(te.c)((function(e){return e.face.uploading})),u=Object(te.c)((function(e){return e.face.uploaded})),d=Object(te.c)((function(e){return e.form.token}))||localStorage.getItem("auth-token"),b=Object(Ce.a)(),p=He(l),O=Object(xe.a)({palette:{primary:Pe.a}});return Object(ce.jsxs)(y.a,{container:!0,spacing:2,children:[Object(ce.jsx)(y.a,{item:!0,xs:6,children:Object(ce.jsx)(Te.a,{theme:i&&!u?O:b,children:Object(ce.jsx)(g.a,{variant:"contained",color:i&&!u?"primary":"default",fullWidth:!0,startIcon:Object(ce.jsx)(we.a,{}),onClick:function(){o(!0)},disabled:!!s,children:"Url"})})}),Object(ce.jsx)(y.a,{item:!0,xs:6,children:Object(ce.jsxs)(Te.a,{theme:u?O:b,children:[Object(ce.jsx)("input",{accept:"image/*",style:{display:"none"},id:"raised-button-file",multiple:!0,type:"file",onChange:function(e){e.preventDefault(),e.target.files[0]&&t(Q(e.target.files[0]))},disabled:!!s}),Object(ce.jsx)("label",{htmlFor:"raised-button-file",children:Object(ce.jsx)(g.a,{component:"span",variant:"contained",color:"primary",fullWidth:!0,className:p.uploaded,startIcon:l?Object(ce.jsx)(Me,{}):u?Object(ce.jsx)(Re.a,{}):Object(ce.jsx)(ve.a,{}),children:"Upload"})})]})}),Object(ce.jsx)(y.a,{item:!0,xs:12,children:Object(ce.jsx)(g.a,{className:p.faceButtonStyle,variant:"contained",color:"secondary",fullWidth:!0,disabled:!!s,size:"large",onClick:function(){return t(function(e,t,a){return function(n){console.log("@TOKWN",a),n(Z()),B.post("/image",{input:e},{headers:{"Content-Type":"application/json","auth-token":a}}).then((function(e){return $(e,t)})).then((function(e){return n(J(e))})).catch((function(e){return n(X(e))}))}}(i,e.imageDementions,d))},children:"Analyze Faces"})}),Object(ce.jsx)(De,{open:c,onClose:function(){o(!1)}})]})},Ve=a(208),ze=r.a.forwardRef((function(e,t){return Object(ce.jsx)(Ve.a,Object(i.a)({direction:"up",ref:t},e))})),Ye=function(){var e=Object(n.useState)(!0),t=Object(j.a)(e,2),a=t[0],r=t[1],c=function(e){"first"===e.currentTarget.id&&localStorage.setItem("showFirstTimeDialog",!1),r(!1)};return Object(ce.jsxs)(Ae.a,{open:a,TransitionComponent:ze,keepMounted:!0,onClose:c,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(ce.jsx)(ke.a,{id:"alert-dialog-slide-title",children:"Wellcome to Smart-Face"}),Object(ce.jsx)(Ee.a,{children:Object(ce.jsx)(_e.a,{id:"alert-dialog-slide-description",children:"Hey, Wellcome to Smart-Face, This app will discover faces in your pictures. You can choose your image by providing image url or upload your own image from device. Here is a picture for example, press the analyze faces button to see the magic :)"})}),Object(ce.jsxs)(Fe.a,{children:[Object(ce.jsx)(g.a,{onClick:c,color:"primary",children:"Ok"}),Object(ce.jsx)(g.a,{id:"first",onClick:c,color:"primary",children:"Dont Show Anymore"})]})]})},Be=Object(v.a)((function(e){var t;return{cardMedia:{marginBottom:e.spacing(2)},imageContainer:{display:"flex",justifyContent:"center",position:"relative"},image:(t={filter:function(e){return e.isUploading||!e.isImageLoaded?"blur(8px)":null}},Object(ue.a)(t,e.breakpoints.only("xs"),{maxHeight:"100%",maxWidth:"100%"}),Object(ue.a)(t,e.breakpoints.up("sm"),{maxHeight:"600px",maxWidth:"100%"}),Object(ue.a)(t,e.breakpoints.up("md"),{maxHeight:"600px",maxWidth:"100%"}),Object(ue.a)(t,e.breakpoints.up("lg"),{maxHeight:"350px",maxWidth:"100%"}),Object(ue.a)(t,e.breakpoints.up("xl"),{maxHeight:"600px",maxWidth:"100%"}),Object(ue.a)(t,"objectFit","contain"),t),skeleton:{marginBottom:e.spacing(2)},box:{position:"absolute",boxShadow:" 0 0 0 3px #149df2 inset",zIndex:"144"},uploadLoader:{display:function(e){return e.isUploading?"block":"none"},position:"absolute",top:"50%"},scanner:{display:function(e){return e.isLoading&&!e.isUploading?"block":"none"},width:"100%",height:"3px",backgroundColor:"red",opacity:"0.7",position:"absolute",boxShadow:"0px 0px 8px 10px rgba(170, 11, 23, 0.49)",top:"50%",animationName:"$scan",animationDuration:"4s",animationTimingFunction:"linear",animationIterationCount:"infinite",zIndex:"200",animationPlayState:function(e){return e.isLoading?"running":"paused"}},"@keyframes scan":{"0%":{boxShadow:"0px 0px 8px 10px rgba(170, 11, 23, 0.49)",top:"50%"},"25%":{boxShadow:" 0px 6px 8px 10px rgba(170, 11, 23, 0.49)",top:"5px"},"75%":{boxShadow:"0px - 6px 8px 10px rgba(170, 11, 23, 0.49)",top:"98%"}}}})),qe=function(){var e=Object(n.useState)({width:"",height:""}),t=Object(j.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),o=Object(j.a)(c,2),s=o[0],l=o[1],u=Object(n.useState)(!1),d=Object(j.a)(u,2),m=d[0],f=d[1],h=Object(te.b)(),g=Object(te.c)((function(e){return e.face.url})),y=Object(n.useRef)(null),v=Object(te.c)((function(e){return e.face.boxes})),S=Object(te.c)((function(e){return e.face.loading})),w=Object(te.c)((function(e){return e.face.uploading})),C=Be({isImageLoaded:s,isUploading:w,isLoading:S}),T=Object(te.c)((function(e){return e.face.progress})),A=localStorage.getItem("showFirstTimeDialog"),k=Object(te.c)((function(e){return e.form.id})),E=(Object(ne.h)(),v?v.map((function(e,t){return Object(ce.jsx)(de.a,Object(i.a)(Object(i.a)({in:m,style:{transformOrigin:"0 0 0"}},m?{timeout:1e3}:{}),{},{children:Object(ce.jsx)("div",{className:C.box,style:{top:e.topRow,right:e.rightCol,bottom:e.bottomRow,left:e.leftCol}})}),t)})):{});return Object(n.useEffect)((function(){f(!!v),g&&(l(!1),y.current.src=g,y.current.onload=function(){r({width:y.current.clientWidth,height:y.current.clientHeight}),l(!0)})}),[g,v]),Object(n.useEffect)((function(){void 0!==k?h(ee(k)):console.log(k)}),[k]),Object(ce.jsxs)(b.a,{children:[A?null:Object(ce.jsx)(Ye,{}),Object(ce.jsx)(p.a,{children:Object(ce.jsxs)(O.a,{children:[Object(ce.jsx)(ge,{}),!s||w?Object(ce.jsx)(x.a,{value:T}):null,Object(ce.jsx)(je.a,{className:C.cardMedia,title:"Smart-Face",children:Object(ce.jsxs)("div",{className:C.imageContainer,children:[Object(ce.jsx)("div",{className:C.scanner}),Object(ce.jsx)("img",{alt:"img",className:C.image,ref:y}),v?E:Object(ce.jsx)("div",{})]})}),Object(ce.jsx)(Ge,{imageDementions:a})]})})]})},Ke=function(){var e=Object(d.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("auth-token"),e.prev=1,e.next=4,B.post("/verify",{},{headers:{"Content-Type":"application/json","auth-token":a}});case 4:if(200!==(n=e.sent).status){e.next=8;break}return t(q(n.data)),e.abrupt("return",!0);case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",!1);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),Ze=function(e){var t=e.component,a=Object(s.a)(e,["component"]);return Object(ce.jsx)(ne.b,Object(i.a)(Object(i.a)({},a),{},{render:function(e){return Ke(a.dispatch)?Object(ce.jsx)(t,Object(i.a)({},e)):Object(ce.jsx)(ne.a,{to:{pathname:"/",state:{from:e.location}}})}}))},Je=function(){var e=Object(te.b)();return Object(ce.jsx)("div",{className:"App",children:Object(ce.jsx)(ne.d,{children:Object(ce.jsxs)(le,{children:[Object(ce.jsx)(ne.b,{exact:!0,path:"/smart-face",component:ie}),Object(ce.jsx)(ne.b,{exact:!0,path:"/register",component:ie}),Object(ce.jsx)(Ze,{dispatch:e,path:"/face",component:qe})]})})})},Xe=Object(xe.a)({typography:{caption:{fontSize:"0.60rem"}}}),$e=a(101),Qe=a(43),et={token:"",loading:"",error:"",verified:"",id:""},tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return Object(i.a)(Object(i.a)({},e),{},{loading:!0,error:""});case A:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,error:"",token:t.token});case k:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,error:t.error});case U:return Object(i.a)(Object(i.a)({},e),{},{verified:!1});case W:return Object(i.a)(Object(i.a)({},e),{},{verified:!0,id:t.id});case M:return Object(i.a)(Object(i.a)({},e),{},{verified:!1});default:return e}},at={user:"",url:"https://images.unsplash.com/photo-1522202176988-66273c2fd55f?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1051&q=80",loading:!1,boxes:[],error:"",uploading:!1,uploaded:!1,progress:0,loadingProfile:!1},nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(i.a)(Object(i.a)({},e),{},{uploaded:!1,url:t.url,boxes:[]});case _:return Object(i.a)(Object(i.a)({},e),{},{loading:!0,boxes:[]});case F:return Object(i.a)(Object(i.a)({},e),{},{boxes:t.boxes,loading:!1,user:t.user});case I:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,error:t.error});case D:return Object(i.a)(Object(i.a)({},e),{},{loading:!0,uploading:!0,boxes:[]});case N:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,uploading:!1,url:t.url,uploaded:!0});case R:return Object(i.a)(Object(i.a)({},e),{},{loading:!1,uploading:!1,error:t.error,uploaded:!1});case P:return Object(i.a)(Object(i.a)({},e),{},{progress:t.value});case L:return Object(i.a)(Object(i.a)({},e),{},{user:t.user});case H:return Object(i.a)(Object(i.a)({},e),{},{loadingProfile:!0});case G:return Object(i.a)(Object(i.a)({},e),{},{loadingProfile:!1,user:t.user});case V:return Object(i.a)(Object(i.a)({},e),{},{loadingProfile:!1,error:t.error});default:return e}},rt=Qe.d,ct=Object(Qe.c)({form:tt,face:nt}),ot=Object(Qe.e)(ct,rt(Object(Qe.a)($e.a)));o.a.render(Object(ce.jsx)(r.a.StrictMode,{children:Object(ce.jsx)(C.a,{children:Object(ce.jsx)(te.a,{store:ot,children:Object(ce.jsx)(Te.a,{theme:Xe,children:Object(ce.jsx)(Je,{})})})})}),document.getElementById("root"))}},[[148,1,2]]]);
//# sourceMappingURL=main.8ef938a0.chunk.js.map